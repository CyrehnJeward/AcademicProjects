<!DOCTYPE html>
<html lang="en">
  
  <head>
    <script src="inputFieldFunctions.js"></script>
    <link rel="stylesheet" href="stylesheet2.css" />
    <title>Page Title</title>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    
   
  </head>
  <body>
    <div class="header">
      <h1>My Dashboard</h1>
    </div>

    <div class="navbar">
      <a href="CustomerLoginDashboard.html" >Home</a>
      <a href="CustomerTransferFunds.html">Transfer Funds</a>
      <a href="CustomerInfo.html" class="active">About Me</a>
      <a href="LoginForm.html" class="right">Logout</a>
     
    </div>

    <div class="row">
      <div class="side">
        <h2>Uploaded ID</h2>
       
       
        <img src="" id = "picturePath" height = "200px" alt ="">
        <div class="fakeimg" style="height: 200px"></div>
        <div class="fakeimg" style="height: 200px"></div>
        <div class="fakeimg" style="height: 200px"></div>
        
      
      </div>
      <div class="main">
        <h2>Account Information</h2>
        <p>Some text about me in culpa qui officia deserunt mollit anim..</p>
        <h3>Name :</h3>
        <h5 id ="name">Lorem ipsum dolor sit ame.</h5>
        <h3>Email Address :</h3>
        <h5 id ="emailAddress">Lorem ipsum dolor sit ame.</h5>
        <h3 >Gender :</h3>
        <h5 id ="gender">Lorem ipsum dolor sit ame.</h5>
        <h3>Email Verified? :</h3>
        <h5 id ="emailVerified">Lorem ipsum dolor sit ame.</h5>
        <form id = "verifyEmail" style = "border: 0px" action ="VerifyEmail.php">
            <label for="emailAddress"><b> Input Email Address for Confirmation</b></label>
            <input type="email"  name ="emailAddress"required style=" width: 100%;
            padding: 12px 20px;
            margin: 8px 0;
            display: inline-block;
            border: 1px solid #ccc;
            box-sizing: border-box; "/> <br />
             <div style="visibility:hidden">
             <input type="text" style ="padding: 1px 1px;
             margin: 1px 0" name ="userID" id = "userID" required >
            </div>
            <input type="submit" value="Verify Email!">
        </form>
        <h5 id = "message"> </h5>
        
        <h3>ID Verified? :</h3>
        <h5 id ="IDVerified">Lorem ipsum dolor sit ame.</h5>
      
        <div class="fakeimg" style="height: 100px"></div>
        
      </div>
    </div>

    <div class="footer">
      <h2>National Bank</h2>
    </div>
  </body>
</html>
<script>
  window.onload = function () {
    
    // const queryString = window.location.search;
    // const urlParams = new URLSearchParams(queryString);
    // var userID =  urlParams.get("ID");
    // sessionStorage.setItem("ID",userID);
    setIDtoSessionStorage();
    sessionStorageCheckID();

    const queryString = window.location.search;
    const urlParams = new URLSearchParams(queryString);
    if(urlParams.has("status")){
      var userID =  urlParams.get("status");
      
      if(userID === "WrongEmail" ){
        message.textContent = "WRONG EMAIL ADDRESS";
        // message.style.colour = "FF0000";
      }
      if(userID === "EmailSent" ){
        message.textContent = "Email sent! Please check your email.";
        // message.style.colour = "FF0000";
      }
      if(userID === "EmailNotSent" ){
        message.textContent = "ERROR OCCURED Email not sent.";
        // message.style.colour = "FF0000";
      }
      if(userID === "EmailVerified" ){
        message.textContent = "EMAIL HAS BEEN VERIFIED.";
        // message.style.colour = "FF0000";
      }

    }

  };

  document.getElementById("userID").value = sessionStorage.getItem("ID");
  var httpRequest;
  var start = 0;
  //   document.getElementById("request").addEventListener("click", makeRequest);
  var httpRequest = new XMLHttpRequest();
  httpRequest.onreadystatechange = function () {
    if (httpRequest.readyState === httpRequest.DONE) {
      if (httpRequest.status === 200) {
        //alert(httpRequest.responseText);
      
        myObj = JSON.parse(httpRequest.responseText);
        for (var key of Object.keys(myObj)) {
         
            
          var name = document.getElementById("name");
          name.textContent = myObj[key].Name;
          
          var emailAddress = document.getElementById("emailAddress");
          emailAddress.textContent = myObj[key].emailAddress;
          
          var gender = document.getElementById("gender");
          gender.textContent = myObj[key].gender;
          

          var emailVerified = document.getElementById("emailVerified");
          if(myObj[key].emailVerified === 1){
            emailVerified.textContent = "Email verified";
            var form = document.getElementById("verifyEmail");
            form.style.visibility = "hidden";

          }else{
            emailVerified.textContent = "Email has not been verified";
            document.getElementById('verifyEmail').hidden = false;
            var form = document.getElementById("verifyEmail");
            form.style.visibility = "block";
          }

         
          
        //   check_EmailVerified(); 

          var IDVerified = document.getElementById("IDVerified");
          IDVerified.textContent = myObj[key].IDVerified;

          if(myObj[key].IDVerified === 1){
            IDVerified.textContent = "ID has been verified";
          

          }else{
            IDVerified.textContent = "ID has not been verified yet";
            document.getElementById('verifyEmail').hidden = false;
        
          }

          
          var picturePath = document.getElementById("picturePath");
          picturePath.src = myObj[key].picturePath;
        
        }
        // for(var key of Object.keys(myObj[1])){
        //   document.getElementById("photoID").src = myObj[key].picturePath
        // }
      } else {
        alert("Something's wrong here!");
      }
    }
    // table.setAttribute("class", "myId");
  }


  httpRequest.open("get", "GetData3.php?Table=ViewUserInfo&userID=" +sessionStorage.getItem("ID"));
  // "GetData.php?Table=ViewUserSecurityKeys&rStart="+start+"&userID="+0
  httpRequest.send();
</script>
