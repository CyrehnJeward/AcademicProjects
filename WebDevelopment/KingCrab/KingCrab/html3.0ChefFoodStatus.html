<!DOCTYPE html>
<html lang="en">
  
  <head>
    <script src="inputFieldFunctions.js"></script>
    <link rel="stylesheet" href="stylesheet2.css" />
    <title>Page Title</title>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    
   
  </head>
  <body>
    <div class="header">
      <h1>Chef JOEWARD</h1>
    </div>

    <div class="navbar">
     
      <a href="htmlLogin.html" class="right">Logout</a>


    </div>

    <div class="row">
      
      <div class="main">
        <h2>Kitchen</h2>
        <table class="centerflex" id="table"></table>
      </div>
    </div>

    <div class="footer">
      <h2>King Crab Restaurant</h2>
    </div>
  </body>
</html>
<script>

  //received is enabled and disables when its value is   1
  //ready is disabled until received value is 1
  //ready value being 1 means food is ready to pick up by waiter

  var table = document.getElementById("table");
  var thead, tr, td;
  table.appendChild((thead = document.createElement("thead")));
  thead.appendChild((tr = document.createElement("tr")));
  tr.appendChild((td = document.createElement("td")));
  td.innerHTML = "<center><b>Customer Name: </center>";
  tr.appendChild((td = document.createElement("td")));
  td.innerHTML = "<center><b>Table Number: </center>";
  tr.appendChild((td = document.createElement("td")));
  td.innerHTML = "<center><b>Food Name: </center>";
  tr.appendChild((td = document.createElement("td")));
  td.innerHTML = "<center><b>Food Quantity</center>";
  tr.appendChild((td = document.createElement("td")));
  td.innerHTML = "<center><b>Process</center>";
  tr.appendChild((td = document.createElement("td")));
  td.innerHTML = "<center><b>Cancellation</center>";

 
  var httpRequest;
  var start = 0;
  //   document.getElementById("request").addEventListener("click", makeRequest);
  var httpRequest = new XMLHttpRequest();
  httpRequest.onreadystatechange = function () {
    if (httpRequest.readyState === httpRequest.DONE) {
      if (httpRequest.status === 200) {
        //alert(httpRequest.responseText);
        var rows = document.getElementById("table").rows.length;
        var rows = document.getElementById("table").rows.length;
        
        if(rows > 2 ){
            for (let i = rows; i > 1; i--){
                document.getElementById("table").deleteRow(i-1);
            }
        }
        myObj = JSON.parse(httpRequest.responseText);
        for (var key of Object.keys(myObj)) {
          tr = document.createElement("tr");
          tr.setAttribute("id", "row" + key);
          // if (key % 2 == 0) {
          //   tr.setAttribute("style", "background:white");
          // }
          
            
          // change lines 95-102 to database column names
          //#region Edit this form database
          table.appendChild(tr);
          tr.appendChild((td = document.createElement("td")));
          td.innerHTML = myObj[key].Customer;
          tr.appendChild((td = document.createElement("td")));
          td.innerHTML = myObj[key].TableNumber;
          tr.appendChild((td = document.createElement("td")));
          td.innerHTML = myObj[key].Dish;
          tr.appendChild((td = document.createElement("td")));
          td.innerHTML = myObj[key].DishQuantity;
        
          
          //-------------------------------------------------//
          
          tr.appendChild((td = document.createElement("td")));
          var btn = document.createElement("input");
          btn.type = "button";
          btn.className = "btn";
          btn.value = myObj[key].DishStatus;
          var statuses = btn.value;

          if(myObj[key].DishStatus == 0){
            // btn.setAttribute('disabled', '');
            //btn.disabled = true;
            btn.value = "Confirm Order";
          }

          if(myObj[key].DishStatus == 1){
            // btn.setAttribute('disabled', '');
            //btn.disabled = true;
            btn.value = "Cooking";
          }

          if(myObj[key].DishStatus == 2){
            // btn.setAttribute('disabled', '');
            btn.value = "Complete Dish";
            btn.disabled = true;
          }

          btn.onclick = (function (key) {
            return function () {
              updateStatus(key);
              document.location.reload();
            };
          })(key);
          td.appendChild(btn);

          //-------------------------------------------------//

          tr.appendChild((td = document.createElement("td")));
          var btn2 = document.createElement("input");
          btn2.type = "button";
          btn2.className = "btn";
          btn2.value = "Cancel";
          if(statuses != '1'){
            // btn.setAttribute('disabled', '');
            btn2.disabled = true;
          }

          btn2.onclick = (function (key) {
            return function () {
              removeStatus(key);
              document.location.reload();
            };
          })(key);
          td.appendChild(btn2);

          //-------------------------------------------------//
        //#endregion Edit this form database

         
        }
      } else {
        alert("Something's wrong here!");
      }
    }
    // table.setAttribute("class", "myId");
  }

  function updateStatus(key) {
    httpRequest.open("get","GetTableDataChef.php?Table=viewFoodOrderDetail&updateID="+key);
    httpRequest.send();
  }

  function removeStatus(key) {
    //alert(key);
    httpRequest.open("get", "PHP3.0RemoveDishStatus.php?Table=viewFoodOrderDetail&updateID="+key);
    httpRequest.send();
    document.location.reload()
  }


  httpRequest.open("get", "GetTableDataChef.php?Table=viewFoodOrderDetail&updateID="+0);
  httpRequest.send();
</script>